<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="http://code.jquery.com/jquery-3.1.1.js"></script>
	<script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>

        body {
            background-color : #002029;
            padding : 20px;
        }

        .toggle {}

        .r-corners {
            border-radius: 10px;
        }

        .card {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            background-color : #004052;
        }

        .title {
            padding: 10px;
        }

        .center {
            margin-left: auto;  
            margin-right: auto;   
        }

        .footer {
            height: 70px;
        }
    </style>

    <title>LED Control Through Web Server</title>
</head>
<body>
    <div class="container-fluid row text-white">
        <div class="col-5">
            <div class="card r-corners title">
                <h2><i class="fa-solid fa-diagram-project"></i> Application of IoT Dashboard</h2>
            </div>
        </div>
        <div class="col-3">
            <div class="card r-corners title">
                <h2><i class="fa-solid fa-user"></i> 劉泰佑</h2>
            </div>
        </div>
        <div class="col-4">
            <div class="card r-corners title">
                <h2><i class="fa-solid fa-id-badge"></i> C100E030</h2>
            </div>
        </div>
    </div>

    <br><br>

    <div class="container-fluid row" id="app">
        <div class="col-6">
            <!------------------------------------   LED Control  ---------------------------------------------------->
            <div class="card r-corners">
                <div class="card-body">
                    <p class="font-weight-light" style="font-size:30px; color:#06cdef"><i class="fa-solid fa-sliders" style="color:#06cdef"></i> LED Control</p>
                    <iframe src="LED/led-ctrl.html" title="LED Control Panel" height="120px" width="100%" frameBorder="0"></iframe>
                </div>
            </div>
            <br>
            <!------------------------------------   Temperature and Humidity Log  ---------------------------------------------------->
            <div class="card r-corners">
                <div class="card-body">
                    <p class="font-weight-light" style="font-size:30px; color:#06cdef"><i class="fa-solid fa-align-justify" style="color:#06cdef"></i> Temperature and Humidity Log</p>
                    <iframe src="sh.php" title="LED Control Panel" height="385px" width="100%" frameBorder="0"></iframe>
                </div>
            </div>
        </div>

        <div class="col-6">
            <!------------------------------------   Temperature and Humidity Input  ---------------------------------------------------->
            <div class="card r-corners">
                <div class="card-body">
                    <p class="font-weight-light" style="font-size:30px; color:#06cdef"><i class="fa-solid fa-arrow-right-from-bracket" style="color:#06cdef"></i> Input Temperature and Humidity</p>
                    <iframe src="th.html" title="LED Control Panel" height="150px" width="100%" frameBorder="0"></iframe>
                </div>
            </div>
            <br>
            <!------------------------------------   Temperature and Humidity Dashboard  ---------------------------------------------------->
            <div class="card r-corners">
                <div class="card-body" id="relod">
                    <p class="font-weight-light" style="font-size:30px; color:#06cdef"><i class="fa-solid fa-info" style="color:#06cdef"></i> Temperature And Humidity Dashboard</p>
                    <table class="table text-center text-white">
                        <thead>
                            <tr>
                                <th>
                                    Temperature (C)
                                </th>
                                <th>
                                    Humidity (%)
                                </th>
                                <th>
                                    Color Status
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>
                                    &nbsp;{{Temp}}&nbsp;
                                </th>
                                <th>
                                    &nbsp;{{Humidity}}&nbsp;
                                </th>
                                <th>
                                    <p id="warnaM" class="text-danger font-weight-bold">&nbsp;{{Color}}&nbsp;</p>
                                    <p id="warnaH" class="text-success font-weight-bold">&nbsp;{{Color}}&nbsp;</p>
                                    <p id="warnaB" class="text-primary font-weight-bold">&nbsp;{{Color}}&nbsp;</p>
                                    <p id="warnaX" class="text-secondary font-weight-bold">&nbsp;{{Color}}&nbsp;</p>
                                </th>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="card-footer text-center text-white">
                    Last updated on : &nbsp;{{Time}}&nbsp;
                </div>
            </div>
            <br>
            <!------------------------------------   Clock  ---------------------------------------------------->
            <div class="card r-corners">
                <div class="card-body">
                    <p class="font-weight-light" style="font-size:30px; color:#06cdef"><i class="fa-solid fa-clock" style="color:#06cdef"></i> Current Time</p>
                    <iframe src="time.html" title="LED Control Panel" height="50px" width="100%" frameBorder="0"></iframe>
                </div>
            </div>
        </div>
    </div>

    <br>

    <div class="container-fluid row">
        <div class="col-12">
            <div class="card r-corners footer">
                <div class="card-body">
                    <p class="font-weight-light" style="font-size:20px; color:#06cdef">
                        Luthfi Kusumajadi - 劉泰佑 <i class="fa-solid fa-copyright" style="color:#06cdef"></i> 2022
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function getledstatus(){
			$.get("LED/GetLED.php", function (data, status) {
					//parse data returned by GetSW.php 
					var objr = JSON.parse(data)[0];
					var objg = JSON.parse(data)[0];
					var objb = JSON.parse(data)[0];
					//retrive the item "SWITCH" from the parsed data
					//according the retrived item obj["SWITCH"] assign "ON" "OFF" to vue_app.SW  
					if (objr['RedLED']=='1' && objg['GreenLED']=='0' && objb['BlueLED']=='0'){
                        vue_app.Color="RED";
                        document.getElementById("warnaM").style.display = "block";
                        document.getElementById("warnaH").style.display = "none";
                        document.getElementById("warnaB").style.display = "none";
                        document.getElementById("warnaX").style.display = "none";
                    }
					else if (objr['RedLED']=='0' && objg['GreenLED']=='1' && objb['BlueLED']=='0'){
                        vue_app.Color="GREEN";
                        document.getElementById("warnaM").style.display = "none";
                        document.getElementById("warnaH").style.display = "block";
                        document.getElementById("warnaB").style.display = "none";
                        document.getElementById("warnaX").style.display = "none";
                    }
					else if (objr['RedLED']=='0' && objg['GreenLED']=='0' && objb['BlueLED']=='1'){
                        vue_app.Color="BLUE";
                        document.getElementById("warnaM").style.display = "none";
                        document.getElementById("warnaH").style.display = "none";
                        document.getElementById("warnaB").style.display = "block";
                        document.getElementById("warnaX").style.display = "none";
                    }
                    else {
                        vue_app.Color="N/A";
                        document.getElementById("warnaM").style.display = "none";
                        document.getElementById("warnaH").style.display = "none";
                        document.getElementById("warnaB").style.display = "none";
                        document.getElementById("warnaX").style.display = "block";
                    }	
			});	
		}

        function getdhtstatus(){
			$.get("GetDHT.php", function (data, status) {
					//parse data returned by GetSW.php 
					var objt = JSON.parse(data)[0];
					var objh = JSON.parse(data)[0];
					var objx = JSON.parse(data)[0];

					//retrive the item "SWITCH" from the parsed data
					//according the retrived item obj["SWITCH"] assign "ON" "OFF" to vue_app.SW
                    if (objt['Temp']==null){}
                    else if (objt['Temp']!=null){vue_app.Temp = objt.Temp;}

                    if (objh['Humidity']==null){}
                    else if (objh['Humidity']!=null){vue_app.Humidity = objh.Humidity;}

                    if (objx['Time']==null){}
                    else if (objx['Time']!=null){vue_app.Time = objx.Time;}
			});	
		}
					
		var vue_app = new Vue({
            el: '#app',
            data: {
                RL: "",
                GL: "",
                BL: "",
                Temp: "",
                Humidity: "",
                Time: "",
                Color: ""
            }
        });
        getledstatus();
        getdhtstatus();

        function doRefresh(){
            $("#relod");
        }
        $(function() {
            setInterval(doRefresh, 5000);
        });
    </script>
</body>
</html>